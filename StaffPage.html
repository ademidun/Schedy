<!DOCTYPE html>
<html>
<head>
<style type="text/css">
  button{
    margin: 2%;
  }
  input{
    margin: 2% !important;
  }
</style>
    <head>
    <title> Calendar Plus</title>
        
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>

    <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <link href="responsive-calendar.css" rel="stylesheet" media="screen">
    <script src="responsive-calendar2.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="calendario/css/calendar.css" />
    <link rel="stylesheet" type="text/css" href="calendario/css/custom_2.css" />
    <script src="js/modernizr.custom.63321.js"></script>
    <link rel ="stylesheet" type ="text/css" href="Atila Style.css" />
    <link rel ="stylesheet" type ="text/css" href="calendar-style.css" />
    <link href="responsive-calendar/responsive-calendar.css" rel="stylesheet" media="screen">
    <script src="responsive-calendar/responsive-calendar2.js"></script>
    </head>

<body>      
      <div id="header">
            <script src="https://cdn.firebase.com/js/client/2.2.9/firebase.js"></script>
            <h1 style="color: black !important"> Calendar Plus</h1>
            
            <p id="date"></p> 
            <ul class="nav nav-pills nav-justified">
              <li class= "headerbar"><a href="index.html">Home <i class="fa fa-home"> </i> </a></li>
              <li class= "headerbar" class="dropdown" ><a class="dropdown-toggle" 
              data-toggle="dropdown" href="clutter folder/Atila Tech 1.html" class= "headerbar">Technology <span class ="caret"></span></a>
                <ul class="dropdown-menu">
                    <li class= "headerbar"><a href="TechHome.php">Web Design</a></li>
                    <li class= "headerbar"><a href="atila tech 1.html">App Dev</a></li>
                    <li class= "headerbar"><a href="#">Investments</a></li> 
                    </ul>
              </li>
              <li class= "headerbar"><a href="#">About Us</a></li>
              <li class= "headerbar"><a href="#">Finance</a></li>
              <li class= "headerbar"><a href="atila contact us.html">Contact Us</a></li>
            </ul>
    </div>
    
          <div class="content-calendar">
          <h1> Staff's Schedule </h1>
          </div>
             
            <form onclick: 'calendarLoad()'>
                       <p>Pick a date:</p><input type="date" id="dateInput" name="event-date"><br>
                       <p>Start Time:</p> <input type="time" name="event-start" id="startTimeInput">
                       <p>End Time:</p> <input type="time" name="event-end" id="endTimeInput">
                       <p>Course:</p> <input type="text" name="course" id="courseInput">
                       <p>Capacity:</p> <input type="numeric" name="capacity" id="capacityInput">
            </form>
                      <button class="btn btn-primary" style="background-color:#33B5E5;border-color:#33B5E5;margin:2%" onclick="bookAppointment()">Register new office hour</button>
                      <button class="btn btn-primary btn-calendar" style="background-color:#33B5E5;border-color:#33B5E5;margin:2%"> Check Schedule</button>
                      <input type="submit" value="Check Students"></input>
                    <!--   Calendario start -->
                    <div id="custom-inner" class="custom-inner hide">
            <div class="custom-header clearfix hide">
              <nav>
                <span id="custom-prev" class="custom-prev"></span>
                <span id="custom-next" class="custom-next"></span>
              </nav>
              <h2 id="custom-month" class="custom-month">September</h2>
              <h3 id="custom-year" class="custom-year">2015</h3>
            </div>
</div>
            <div id="custom-inner" class="custom-inner hide">
            <div class="custom-header clearfix">
              <nav>
                <span id="custom-prev" class="custom-prev"></span>
                <span id="custom-next" class="custom-next"></span>
              </nav>
              <h2 id="custom-month" class="custom-month"></h2>
              <h3 id="custom-year" class="custom-year"></h3>
            </div>
            <div id="calendar" class="fc-calendar-container"></div>
          </div>
          <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <script type="text/javascript" src="js/jquery.calendario.js"></script>
    <script type="text/javascript" src="js/data.js"></script>
    <script>
      var myFirebaseRef = new Firebase("https://schedy.firebaseio.com/");
      var offHoursRef = myFirebaseRef.child("office_hours");

      var authData = myFirebaseRef.getAuth();
      if (authData) {
        console.log("User " + authData.uid + " is logged in with " + authData.provider);
        var userid = authData.uid;
      } else {
        console.log("User is logged out");
      }

      function bookAppointment(){
          var dateIn = $('#dateInput').val();
          var startTimeIn = $('#startTimeInput').val();
          var endTimeIn = $('#endTimeInput').val();
          var courseIn = $('#courseInput').val();
          var capacityIn = $('#capacityInput').val();

          offHoursRef.push({
            start: startTimeIn,
            end: endTimeIn,
            course: courseIn,
            date: dateIn,
            capacity: capacityIn,
            staff_id: userid
          }); 

          alert('Your new office hour was registered. Thank you!');
          
      }

    </script>
    <script> 
    /*any variables which I want to use across multiple files,
     must be declared here, providing them with global scope*/

var codropsEvents = {

  // '09-21-2015' : '<a href="http://tympanus.net/codrops/2012/11/21/adaptive-thumbnail-pile-effect-with-automatic-grouping/">Adaptive Thumbnail Pile Effect with Automatic Grouping</a>',
  // '09-25-2015' : '<span>Christmas Day</span>',
  // '09-31-2015' : '<span>New Year\'s Eve</span>'
};
    var userday, userdayArr, eventStart;
      $('.btn-calendar').click(function calendarLoad() {
        var showcal =$('.custom-inner, .custom-header');
        showcal.removeClass('hide');
        userday = $('[name=event-date]').val();
        userdayArr= userday.split('-');
        userdayArr=userdayArr.reverse();
        userday=userdayArr[1]+ '-'+userdayArr[0]+ '-'+ userdayArr[2];
        eventStart = $('[name=event-start]').val();
        eventStartArr=eventStart.split(':');
        eventEnd = $('[name=event-end]').val();
        eventEndArr=eventEnd.split(':');

//populating my object after it has been created to allow for dynamic inputx
  codropsEvents[userday] = '<h3> You have <span id="studentnumber" class="studentcount"> {insert studentCount here}</span> students today</h3> <a href="http://tympanus.net/codrops/2012/11/23/three-script-updates/">Three Script Updates</a><span class="capacity-marker"></span>';
        var transEndEventNames = {
            'WebkitTransition' : 'webkitTransitionEnd',
            'MozTransition' : 'transitionend',
            'OTransition' : 'oTransitionEnd',
            'msTransition' : 'MSTransitionEnd',
            'transition' : 'transitionend'
          },
          transEndEventName = transEndEventNames[ Modernizr.prefixed( 'transition' ) ],
          $wrapper = $( '#custom-inner' ),
          $calendar = $( '#calendar' ),
          cal = $calendar.calendario( {
            onDayClick : function( $el, $contentEl, dateProperties ) {

              if( $contentEl.length > 0 ) {
                showEvents( $contentEl, dateProperties );
              }

            },
            caldata : codropsEvents,
            displayWeekAbbr : true
          } ),
          $month = $( '#custom-month' ).html( cal.getMonthName() ),
          $year = $( '#custom-year' ).html( cal.getYear() );

        $( '#custom-next' ).on( 'click', function() {
          cal.gotoNextMonth( updateMonthYear );
        } );
        $( '#custom-prev' ).on( 'click', function() {
          cal.gotoPreviousMonth( updateMonthYear );
        } );

        function updateMonthYear() {        
          $month.html( cal.getMonthName() );
          $year.html( cal.getYear() );
        }

        // just an example..
        function showEvents( $contentEl, dateProperties ) {

          hideEvents();
          
          var $events = $( '<div id="custom-content-reveal" class="custom-content-reveal"><h4>Events for ' + dateProperties.monthname + ' ' + dateProperties.day + ', ' + dateProperties.year + '</h4></div>' ),
            $close = $( '<span class="custom-content-close"></span>' ).on( 'click', hideEvents );

          $events.append( $contentEl.html() , $close ).insertAfter( $wrapper );
          
          setTimeout( function() {
            $events.css( 'top', '0%' );
          }, 25 );

        }
        function hideEvents() {

          var $events = $( '#custom-content-reveal' );
          if( $events.length > 0 ) {
            
            $events.css( 'top', '100%' );
            Modernizr.csstransitions ? $events.on( transEndEventName, function() { $( this ).remove(); } ) : $events.remove();

          }

        }
        var duration=eventEndArr[0] - eventStartArr[0];//Obviously will require a better algorithm.
        var capacity=duration*12;
        var capacitylocation =$('.capacity-marker');
        var emptyseats='';
        for(var i=0; i<capacity; i++){//# of circles is based on class time
          seatnumber=(i+1);
        emptyseats+=`<i class= \"fa fa-circle-o-notch traffic-none\" id=\"seat${seatnumber}\"></i>`;}
          
        capacitylocation.append(emptyseats);
      return false;
      });
//     </script>
                 <!-- Responsive calendar - START -->
               <!-- <div class="responsive-calendar">
//                   <div class="controls">
//                       <a class="pull-left" data-go="prev"></a>
//                       <h4><span data-head-year></span> <span data-head-month></span></h4>
//                       <a class="pull-right" data-go="next"></a>
//                   </div><hr/>
//                   <div class="day-headers">
//                     <div class="day header">Sun</div>
//                     <div class="day header">Mon</div>
//                     <div class="day header">Tue</div>
//                     <div class="day header">Wed</div>
//                     <div class="day header">Thu</div>
//                     <div class="day header">Fri</div>
//                     <div class="day header 3">Sat</div>
//                   </div>
//                   <div class="days" data-group="days"> -->
                    <!-- the place where days will be generated --><!-- 
//                   </div>
//                 </div> -->
                <!-- Responsive calendar - END -->
                
   </body>
 <script>
// $('button').click(function(){
//  i= $('[name=event-count]').val();
// j = $('[name=event-date]').val();
// //so I can remove leading zeros without changing the string
// j2=j;
// j2 = j2.replace(/\b0(?=\d)/g, '');
// j2=j2.split('-');
//  $(".responsive-calendar").responsiveCalendar({
//     events: {
//       j: {"number": 5, "badgeClass": "badge-warning"},
//       j: {"number": i, "badgeClass": "badge-warning"}, 
//       "2015-09-03": {"number": i, "badgeClass": "badge-error"}, 
//       "2015-09-12": {"number": 1, "badgeClass": "badge-error"}
//     }
// });
// var userday =`[data-day="${j2[2]}"][data-month="${j2[1]}"][data-year="${j2[0]}"]`;
// userday= document.getElementsByClassName("day header");
// userday =$("div.day");
// userday=userday[0];
// userday.className+=" active";
//  $('.pull-left').prepend('<div class="btn btn-primary">Prev</div>');
//   $('.pull-right').prepend('<div class="btn btn-primary">Next</div>');
//   var x = document.getElementsByClassName("day past");
//   var xattr;
//   for (var i = 0; i<x.length; i++){
//     if(typeof x[i].getAttribute("data-day")!= 'undefined'){
//       xattr =x[i].getAttribute("data-day");
//       break;
//     }

//   }
//   // $element.find('[data-year="' + time.year + '"][data-month="' + (time.month + 1) + '"][data-day="' + time.day + '"]').parent('.day')
// });
// $('form').submit (function(event){
// i= $('[name=event-count]').val();
// j = $('[name=event-date]').val();
// //so I can remove leading zeros without changing the string
// j2=j;
// j2 = j2.replace(/\b0(?=\d)/g, '');
// j2=j2.split('-');
//  $(".responsive-calendar").responsiveCalendar({
//     events: {
//       j: {"number": 5, "badgeClass": "badge-warning"},
//       j: {"number": i, "badgeClass": "badge-warning"}, 
//       "2015-09-03": {"number": i, "badgeClass": "badge-error"}, 
//       "2015-09-12": {"number": 1, "badgeClass": "badge-error"}
//     }
// });
// var userday =`[data-day="${j2[2]}"][data-month="${j2[1]}"][data-year="${j2[0]}"]`;
// userday= document.getElementsByClassName("day header");
// userday =$("div.day");
// userday=userday[0];
// userday.className+=" active";
//  $('.pull-left').prepend('<div class="btn btn-primary">Prev</div>');
//   $('.pull-right').prepend('<div class="btn btn-primary">Next</div>');
//   var x = document.getElementsByTagName("a");
//   x= x.getAttribute("data-day");
//   // $element.find('[data-year="' + time.year + '"][data-month="' + (time.month + 1) + '"][data-day="' + time.day + '"]').parent('.day')
// return false;
// event.preventDefault();
// });
// </script>
    </html>